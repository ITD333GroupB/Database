@model Class_Project_Database_Portion.ViewModels.UserDashboardViewModel

@{
    ViewData["Title"] = "Dashboard";
}

<div class="container mt-4">
    <h2>Welcome, @Model.Username (ID: @Model.UserId)</h2>
    <hr />

    <!-- Groups -->
    <h3 class="mt-4">Groups Owned: (@Model.GroupsOwned?.Count)</h3>
    @if (Model.GroupsOwned != null && Model.GroupsOwned.Any())
    {
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Group ID</th>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Owner</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var group in Model.GroupsOwned)
                {
                    <tr>
                        <td>@group.GroupId</td>
                        <td>@group.Name</td>
                        <td>@group.Description</td>
                        <td>@group.OwnerUsername</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p>No groups found.</p>
    }

    <!-- Workspaces -->
    <h3 class="mt-4">Workspaces Owned: (@Model.WorkspacesOwned?.Count)</h3>
    @if (Model.WorkspacesOwned != null && Model.WorkspacesOwned.Any())
    {
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Workspace ID</th>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Owner</th>
                    <th>Group</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var ws in Model.WorkspacesOwned)
                {
                    <tr>
                        <td>@ws.WorkspaceId</td>
                        <td>@ws.Name</td>
                        <td>@ws.Description</td>
                        <td>@ws.OwnerUsername</td>
                        <td>@ws.GroupName</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p>No workspaces found.</p>
    }

    <!-- Tasks Assigned -->
    <h3 class="mt-4">Tasks Assigned - (@Model.TasksAssigned?.Count)</h3>
    @if (Model.TasksAssigned != null && Model.TasksAssigned.Any())
    {
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Task ID</th>
                    <th>Name</th>
                    <th>Assignee</th>
                    <th>Status</th>
                    <th>Child Tasks</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var task in Model.TasksAssigned)
                {
                    <tr>
                        <td>@task.TaskId</td>
                        <td>@task.TaskName</td>
                        <td>@task.Assignee</td>
                        <td>@task.TaskStatus</td>
                        <td>
                            @if (task.ChildTasks != null && task.ChildTasks.Any())
                            {
                                <ul>
                                    @foreach (var child in task.ChildTasks)
                                    {
                                        <li>@child.Name (Status: @child.TaskStatus)</li>
                                    }
                                </ul>
                            }
                            else
                            {
                                <span>No child tasks</span>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p>No tasks found.</p>
    }

    <h3>Messages</h3>
    <table class="table">
        <thead>
            <tr>
                <th>Message</th>
                <th>Author</th>
                <th>Created</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var m in Model.UserMessages)
            {
                <tr>
                    <td>@m.MessageContent</td>
                    <td>@m.AuthorUsername</td>
                    <td>@m.CreatedAt</td>
                </tr>
            }
        </tbody>
    </table>




</div>
